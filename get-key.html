<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Key</title>
</head>
<body>
    <script>
        // Rastgele anahtar oluşturma fonksiyonu
        function generateRandomKey(length = 20) {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
            let randomPart = '';
            for (let i = 0; i < length - 4; i++) {
                randomPart += letters.charAt(Math.floor(Math.random() * letters.length));
            }
            return 'ATA-' + randomPart;
        }

        const hwid = new URLSearchParams(window.location.search).get('hwid');
        if (hwid) {
            // Anahtar oluştur ve sunucuya gönder
            const url = 'http://127.0.0.1:5000/create_key';
            const payload = {
                key: generateRandomKey(),
                usage_limit: 1,
                expiration_minutes: 3
            };

            fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
            })
            .catch(error => {
                console.error('Error:', error);
            });
        } else {
            console.error('HWID not found in URL');
        }
    </script>
</body>
</html>
